<?xml version="1.0" encoding="UTF-8"?>
<con:testCase discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" id="cf3e0b4c-e894-4b34-9b4b-c9ba8d665f65" keepSession="false" name="tc_MQ_script" searchProperties="true" timeout="0" xmlns:con="http://eviware.com/soapui/config">
  <con:settings>
    <con:setting id="cf3e0b4c-e894-4b34-9b4b-c9ba8d665f65fileName">tc_MQ_script</con:setting>
  </con:settings>
  <con:testStep id="8a504b8e-e5e0-481f-aac0-3184ed09d28d" name="DataGen" type="datagen">
    <con:settings/>
    <con:config xsi:type="con:DataGeneratorStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:property type="Number">
        <con:configuration>
          <start/>
          <end/>
          <step/>
          <pattern/>
          <random>true</random>
          <persist>false</persist>
        </con:configuration>
        <con:name>randomNumber</con:name>
        <con:mode>STEP</con:mode>
        <con:shared>false</con:shared>
      </con:property>
    </con:config>
  </con:testStep>
  <con:testStep id="8d6f9fa2-92f8-4731-a74f-2713120bc31c" name="Property Transfer" type="transfer">
    <con:settings/>
    <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:transfers entitize="false" failOnError="true" ignoreEmpty="false" setNullOnMissingSource="true" transferChildNodes="false" transferTextContent="true" transferToAll="false">
        <con:name>randomNumber</con:name>
        <con:sourceType>randomNumber</con:sourceType>
        <con:sourceStep>DataGen</con:sourceStep>
        <con:sourcePath/>
        <con:targetType>randomNumber</con:targetType>
        <con:targetStep>#TestCase#</con:targetStep>
        <con:targetPath/>
        <con:upgraded>true</con:upgraded>
      </con:transfers>
    </con:config>
  </con:testStep>
  <con:testStep id="38e02056-01b5-44c8-8fff-9eb02da6e701" name="putMessage" type="groovy">
    <con:settings/>
    <con:config>
      <script>import com.ibm.msg.client.wmq.*;
import com.ibm.mq.jms.*;
import javax.jms.*;

MQQueueConnectionFactory qcf = new MQQueueConnectionFactory();

qcf.setHostName ("localhost");
qcf.setPort (1414);
qcf.setQueueManager ("QM1");
qcf.setChannel ("DEV.APP.SVRCONN");
qcf .setTransportType (WMQConstants.WMQ_CM_CLIENT);

QueueConnection qc = qcf.createQueueConnection ("app","passw0rd"); 
qc.start();

Queue q = new MQQueue ("DEV.QUEUE.1");
QueueSession s = qc.createQueueSession (false, Session.AUTO_ACKNOWLEDGE);
QueueSender qs = s.createSender (q);

Message m = s.createTextMessage (testRunner.testCase.getPropertyValue("randomNumber"));
qs.send (m);

QueueReceiver qr = s.createReceiver(q);
Message receivedMessage = qr.receive();
log.info(receivedMessage.getText())
log.info("Published message has been successfully read again.")
assert receivedMessage.getText() == testRunner.testCase.getPropertyValue("randomNumber")</script>
    </con:config>
  </con:testStep>
  <con:properties>
    <con:property>
      <con:name>randomNumber</con:name>
      <con:value>127707336618979174017629911086897561600</con:value>
    </con:property>
  </con:properties>
  <con:reportParameters/>
</con:testCase>
